# YOLO template project

Проект предназначен для быстрого запуска и обучения нейросети YOLO с помощью проекта darknet.
YOLO скорость работы и точность детекции. YOLO обченная с помощью darknet может показать хороший результат даже при небольшом датасете за счет хорошей аугументации данных в процессе обучения.
Автоматизация процесса обучения достигается за счет создания docker образов.

# Сборка docker образов

## Подготовка к сборке образов
1. Устанавливаем [Docker Engine](https://docs.docker.com/engine/install/ubuntu/) 
2. Для прокидывания GPU внутрь контейнера устанавливаем [NVIDIA Container Toolkit](https://github.com/NVIDIA/nvidia-docker)

## Сборка образов
1. Перейти в директорию проекта
```
cd docker
```
2. Выполнить скрипт 
```
./build.sh
```

# Обучение (train)
В директории **train** проекта содержится файл описания README.md, в котором описано как проводить обучение
Для примера:
1. перейти в директорию train
```
cd train
```
2. создать директорию для хранения данных обучения
```
mkdir ball
```
3. скопирать [данные](https://TODO_upload_data_google_drive) для обучения в директорию ball
4. из директории train запустить скрипт
```
./train-detector.sh ball 1
```
5. Следить за процессом обучения по [ссылке](http://localhost:8090) 

## Проблемы при запуске обучения

Если возникает ошибка **CUDA memory**, то необходимо в конфигурации сети увеличить значения параметра **subdivisions**, значение должно быть кратно степени двойки

# Запуск(inference)
1. Перейти в директорию **inference**
```
cd inference
```
2. Скопировать в директорию конфигурацию и веса сети
```
cp ../train/ball/backup/custom_final.weights ./football.weights
cp ../train/ball/custom.cfg ./football.cfg
```
3. Выполнить команду run.sh 

В качестве параметров необходимо передать два параметра, имя видеофайла для обработки и имя   видеофайла для записи результа.
!Важно файлы с видео должны находиться в директории **inference**
Пример:
```
./run.sh video1.mp4 res-video1.mp4
```
