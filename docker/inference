FROM xentilzax-cuda11.4.2-base

#
# Install OpenCV
#
ARG OPENCV_VERSION="4.5.0"
ARG CUDA="11.4.2"


#
# OpenCV looks for the cuDNN version in cudnn_version.h, but it's been renamed to cudnn_version_v8.h
#
RUN ln -s /usr/include/x86_64-linux-gnu/cudnn_version_v8.h /usr/include/x86_64-linux-gnu/cudnn_version.h

COPY opencv-cuda${CUDA}.deb

RUN DEBIAN_FRONTEND=noninteractive dpkg -i opencv-cuda${CUDA}.deb

#favorite editor
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y nano

RUN ldconfig

RUN rm -rf /var/lib/apt/lists/* \
    && apt-get clean
